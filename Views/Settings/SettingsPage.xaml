<?xml version="1.0" encoding="utf-8" ?>
<shared:BasePage
    x:Class="SpiritualGiftsSurvey.Views.Settings.SettingsPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:c="clr-namespace:SpiritualGiftsSurvey.Views.Controls;assembly=SpiritualGiftsSurvey"
    xmlns:ios="clr-namespace:Microsoft.Maui.Controls.PlatformConfiguration.iOSSpecific;assembly=Microsoft.Maui.Controls"
    xmlns:shared="clr-namespace:SpiritualGiftsSurvey.Views.Shared;assembly=SpiritualGiftsSurvey"
    xmlns:vm="clr-namespace:SpiritualGiftsSurvey.Views.Settings"
    x:DataType="vm:SettingsViewModel"
    ios:NavigationPage.HideNavigationBarSeparator="true"
    FlowDirection="{Binding FlowDirection}"
    NavigationPage.HasNavigationBar="False"
    Shell.NavBarIsVisible="False">

    <NavigationPage.TitleView>
        <StackLayout Orientation="Horizontal" HorizontalOptions="Fill" BackgroundColor="Transparent">
            <ImageButton x:Name="BackArrow"
                         HorizontalOptions="Start"
                         VerticalOptions="Center"
                         WidthRequest="50"
                         HeightRequest="25"
                         BackgroundColor="Transparent"
                         Source="{StaticResource BackArrow}"
                         Command="{Binding NavButtonCommand}" />
            <c:TitleLabel NewStyle="{StaticResource NavTitleLabelStyle}"
                          HorizontalOptions="Fill"
                          FlowDirection="{Binding FlowDirection}"
                          LabelText="{Binding PageTopic}" />
            <ImageButton x:Name="BackArrowRight"
                         HorizontalOptions="End"
                         VerticalOptions="Center"
                         WidthRequest="50"
                         HeightRequest="25"
                         BackgroundColor="Transparent"
                         IsVisible="False"
                         IsEnabled="False"
                         Source="{StaticResource BackArrowRight}"
                         Command="{Binding NavButtonCommand}" />
        </StackLayout>
    </NavigationPage.TitleView>

    <ContentPage.Resources>
        <ResourceDictionary>
            <Style TargetType="ListView">
                <Setter Property="SeparatorColor" Value="Transparent" />
                <Setter Property="SeparatorVisibility" Value="None" />
                <Setter Property="RowHeight" Value="35" />
                <Setter Property="HasUnevenRows" Value="True" />
                <Setter Property="SeparatorVisibility" Value="Default" />
                <Setter Property="SeparatorColor" Value="LightGray" />
                <Setter Property="Margin" Value="0" />
            </Style>
            <Style TargetType="Label">
                <Setter Property="VerticalTextAlignment" Value="Center" />
                <Setter Property="FontSize" Value="24" />
                <Setter Property="FontAttributes" Value="Bold" />
                <Setter Property="TextColor" Value="Gray" />
            </Style>
            <Style TargetType="Image">
                <Setter Property="VerticalOptions" Value="Center" />
                <Setter Property="HorizontalOptions" Value="Start" />
            </Style>
            <Style TargetType="Grid">
                <Setter Property="VerticalOptions" Value="Center" />
                <Setter Property="Padding" Value="20, 10" />
            </Style>
        </ResourceDictionary>
    </ContentPage.Resources>

    <ContentPage.Content>
        <Grid RowDefinitions="Auto,*">
            <Image Source="mainpagebackground"
               VerticalOptions="Fill"
               HorizontalOptions="Fill"
               Aspect="Fill"
               Grid.RowSpan="2" />

            <ScrollView Grid.Row="1">
                <StackLayout VerticalOptions="Start" HorizontalOptions="Fill" Margin="0,40,0,0">
                    <!--<StackLayout Orientation="Horizontal" HorizontalOptions="Fill">
                        <Label Text="{Binding ParallelMode}" HorizontalOptions="Start" TextColor="Black" Margin="30,0" IsEnabled="{Binding IsTablet}" />
                        <Switch x:Name="ParallelMode" HorizontalOptions="End" VerticalOptions="Center" Margin="30,0" IsToggled="{Binding IsParallel, Mode=TwoWay}" IsEnabled="{Binding IsTablet}" />
                    </StackLayout>
                    <Label Text="{Binding TabletRequired}" TextColor="Red" FontSize="Micro" Margin="30,-10,30,50" IsVisible="{Binding IsTablet, Converter={StaticResource NegatedConverter}}" />-->
                    
                    <BoxView HeightRequest="0.5" HorizontalOptions="Fill" />
                    <Grid 
                        Padding="20,10"
                        RowDefinitions="Auto"
                        ColumnDefinitions="*,Auto">

                        <!-- Title -->
                        <Label 
                            Text="{Binding LanguageTitle}" 
                            VerticalOptions="Center" />

                        <!-- Detail -->
                        <Label 
                            Grid.Column="1"
                            Text="{Binding SelectedLanguage.DisplayName}" 
                            VerticalOptions="Center" />

                        <!-- Tap Gesture on the whole Grid -->
                        <Grid.GestureRecognizers>
                            <TapGestureRecognizer Tapped="StudentLanguage_Tapped" />
                        </Grid.GestureRecognizers>

                    </Grid>

                </StackLayout>
            </ScrollView>

            <ContentView x:Name="actIndBackground" BackgroundColor="#222222" Opacity="0.65" Grid.RowSpan="2" IsVisible="{Binding IsLoading}" />
            <StackLayout Orientation="Vertical" IsVisible="{Binding IsLoading}" WidthRequest="300" HeightRequest="100" HorizontalOptions="Center" VerticalOptions="Center">
                <ActivityIndicator IsRunning="True" Color="{StaticResource WhiteSmoke}" />
                <Label Text="{Binding LoadingText}" HorizontalOptions="Center" TextColor="{StaticResource WhiteSmoke}" />
            </StackLayout>

            <Picker x:Name="LanguagePicker" 
                    Title="{Binding LanguageTitle}" 
                    SelectedItem="{Binding SelectedLanguage}" 
                    ItemsSource="{Binding LanguageOptions}" 
                    ItemDisplayBinding="{Binding DisplayName}" 
                    IsVisible="false" 
                    ios:Picker.UpdateMode="WhenFinished" />

        </Grid>
    </ContentPage.Content>
    
</shared:BasePage>